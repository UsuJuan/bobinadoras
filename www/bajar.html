<!doctype html>
<html lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<title>Transferencia de datos</title>
	<link rel="stylesheet" href="css/bootstrap.css" />
	<link rel="stylesheet" href="css/estilos.css" />
</head>
<body>
	<div class="text-right">
		<a href="index.html" class="icono-menu" >
			MENU <span class="glyphicon glyphicon-align-justify" ></span>
		</a>
	</div>
	<div class="alert alert-danger text-center" style="margin-top:3em;" role="alert">
		<h3>
			Error al transferir datos.
		</h3>
	</div>
	<div class="alert alert-success text-center" style="margin-top:3em;" role="alert">
		<h3>
			Los datos se bajaron con exito.
		</h3>
	</div>
	<form class="form-horizontal my_form" role="form" action="" method="POST" >
		<div class="row text-center flechita">
			<span class="glyphicon glyphicon-download"></span>
		</div>
		<div class="row text-center" >
			<button type="submit" style="font-size:4em;" class="btn btn-success btn-lg">Bajar Datos</button>
		</div>
	</form>
	<script type="text/javascript" src="js/jquery.min.js" ></script>
	<script type="text/javascript" src="js/bootstrap.js" ></script>
	<script>

	$(function(){	

		$('.alert-danger').css('display','none');
		$('.alert-success').css('display','none');

		var mostrar_maquinas = function(json){
			maquinas_array = JSON.stringify(json);
			localStorage.setItem("maquinas_bov", maquinas_array);
		};
		var mostrar_turnos = function(json){
			turnos_array = JSON.stringify(json);
			localStorage.setItem("turnos", turnos_array);
		};
		$('form').on('submit',function(evt){
			evt.preventDefault();
			$.getJSON('http://127.0.0.1:8000/transferencias/bajar/maquinas/bovinadoras/?callback=?', mostrar_maquinas)
				.done(function() {
					$('.alert-success').show().delay(5000).fadeOut();
					console.log('exito');
			  	})
			  	.fail(function() {
			  		$('.alert-danger').show().delay(5000).fadeOut();
			  		console.log('fallo');
			  	});				

			$.getJSON('http://127.0.0.1:8000/transferencias/bajar/turnos/?callback=?', mostrar_turnos)
				.done(function() {
			    	$('.alert-success').show().delay(5000).fadeOut();
			    	console.log('exito');
			  	})
			  	.fail(function() {
			    	$('.alert-danger').show().delay(5000).fadeOut();
			    	console.log('fallo');
			  	});	
		});			
      })
	</script>
</body>
</html>